---
apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

patches:
  - target:
      kind: NodeNetworkConfigurationPolicy
      labelSelector: "osp/nncm-config-type=standard"
    path: ocp_node_template.yaml

replacements:
  # DNS
  - source:
      kind: ConfigMap
      name: network-values
      fieldPath: data.dns-resolver.config
    targets:
      - select:
          kind: NodeNetworkConfigurationPolicy
        fieldPaths:
          - spec.desiredState.dns-resolver.config

  # Routes
  - source:
      kind: ConfigMap
      name: network-values
      fieldPath: data.routes
    targets:
      - select:
          kind: NodeNetworkConfigurationPolicy
        fieldPaths:
          - spec.desiredState.routes
